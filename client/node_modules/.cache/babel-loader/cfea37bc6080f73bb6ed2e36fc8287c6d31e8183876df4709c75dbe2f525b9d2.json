{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{Table,Button,Row,Col}from'react-bootstrap';import{useDispatch,useSelector}from'react-redux';import{FaCheck,FaTimes}from'react-icons/fa';import Message from'../components/Message';import Loader from'../components/Loader';import AdminNav from'../components/AdminNav';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const AdminUsersPage=()=>{const[users,setUsers]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[success,setSuccess]=useState(false);const dispatch=useDispatch();const navigate=useNavigate();const userLogin=useSelector(state=>state.userLogin);const{userInfo}=userLogin;useEffect(()=>{// Check if user is admin\nif(!userInfo||userInfo.role!=='admin'){navigate('/login');return;}const fetchUsers=async()=>{try{setLoading(true);const{data}=await axios.get('/api/users',{headers:{Authorization:`Bearer ${userInfo.token}`}});setUsers(data);setLoading(false);}catch(error){setError(error.response&&error.response.data.message?error.response.data.message:error.message);setLoading(false);}};fetchUsers();},[navigate,userInfo,success]);const updateRoleHandler=async(userId,role)=>{if(window.confirm(`Are you sure you want to change this user's role to ${role}?`)){try{await axios.put(`/api/users/${userId}/role`,{role},{headers:{'Content-Type':'application/json',Authorization:`Bearer ${userInfo.token}`}});setSuccess(!success);}catch(error){setError(error.response&&error.response.data.message?error.response.data.message:error.message);}}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Row,{className:\"align-items-center\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"h1\",{children:\"Users\"})})}),/*#__PURE__*/_jsx(AdminNav,{}),loading?/*#__PURE__*/_jsx(Loader,{}):error?/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error}):/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,responsive:true,className:\"table-sm mt-4\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"NAME\"}),/*#__PURE__*/_jsx(\"th\",{children:\"EMAIL\"}),/*#__PURE__*/_jsx(\"th\",{children:\"ROLE\"}),/*#__PURE__*/_jsx(\"th\",{children:\"REGISTERED\"}),/*#__PURE__*/_jsx(\"th\",{children:\"ACTIONS\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.map(user=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:user._id}),/*#__PURE__*/_jsx(\"td\",{children:user.name}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"a\",{href:`mailto:${user.email}`,children:user.email})}),/*#__PURE__*/_jsx(\"td\",{children:user.role_id.name==='admin'?/*#__PURE__*/_jsx(\"span\",{className:\"text-success\",children:\"Admin\"}):/*#__PURE__*/_jsx(\"span\",{children:\"Customer\"})}),/*#__PURE__*/_jsx(\"td\",{children:new Date(user.created_at).toLocaleDateString()}),/*#__PURE__*/_jsx(\"td\",{children:user.role_id.name==='admin'?/*#__PURE__*/_jsx(Button,{variant:\"outline-primary\",className:\"btn-sm\",onClick:()=>updateRoleHandler(user._id,'customer'),children:\"Make Customer\"}):/*#__PURE__*/_jsx(Button,{variant:\"outline-success\",className:\"btn-sm\",onClick:()=>updateRoleHandler(user._id,'admin'),children:\"Make Admin\"})})]},user._id))})]})]});};export default AdminUsersPage;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","Table","Button","Row","Col","useDispatch","useSelector","FaCheck","FaTimes","Message","Loader","AdminNav","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AdminUsersPage","users","setUsers","loading","setLoading","error","setError","success","setSuccess","dispatch","navigate","userLogin","state","userInfo","role","fetchUsers","data","get","headers","Authorization","token","response","message","updateRoleHandler","userId","window","confirm","put","children","className","variant","striped","bordered","hover","responsive","map","user","_id","name","href","email","role_id","Date","created_at","toLocaleDateString","onClick"],"sources":["C:/Users/HP/CascadeProjects/food-ordering-system/client/src/pages/AdminUsersPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Table, Button, Row, Col } from 'react-bootstrap';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { FaCheck, FaTimes } from 'react-icons/fa';\nimport Message from '../components/Message';\nimport Loader from '../components/Loader';\nimport AdminNav from '../components/AdminNav';\nimport axios from 'axios';\n\nconst AdminUsersPage = () => {\n  const [users, setUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [success, setSuccess] = useState(false);\n\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n\n  const userLogin = useSelector((state) => state.userLogin);\n  const { userInfo } = userLogin;\n\n  useEffect(() => {\n    // Check if user is admin\n    if (!userInfo || userInfo.role !== 'admin') {\n      navigate('/login');\n      return;\n    }\n\n    const fetchUsers = async () => {\n      try {\n        setLoading(true);\n        const { data } = await axios.get('/api/users', {\n          headers: { Authorization: `Bearer ${userInfo.token}` },\n        });\n        setUsers(data);\n        setLoading(false);\n      } catch (error) {\n        setError(\n          error.response && error.response.data.message\n            ? error.response.data.message\n            : error.message\n        );\n        setLoading(false);\n      }\n    };\n\n    fetchUsers();\n  }, [navigate, userInfo, success]);\n\n  const updateRoleHandler = async (userId, role) => {\n    if (window.confirm(`Are you sure you want to change this user's role to ${role}?`)) {\n      try {\n        await axios.put(\n          `/api/users/${userId}/role`,\n          { role },\n          {\n            headers: {\n              'Content-Type': 'application/json',\n              Authorization: `Bearer ${userInfo.token}`,\n            },\n          }\n        );\n        setSuccess(!success);\n      } catch (error) {\n        setError(\n          error.response && error.response.data.message\n            ? error.response.data.message\n            : error.message\n        );\n      }\n    }\n  };\n\n  return (\n    <>\n      <Row className=\"align-items-center\">\n        <Col>\n          <h1>Users</h1>\n        </Col>\n      </Row>\n      \n      <AdminNav />\n      \n      {loading ? (\n        <Loader />\n      ) : error ? (\n        <Message variant=\"danger\">{error}</Message>\n      ) : (\n        <Table striped bordered hover responsive className=\"table-sm mt-4\">\n          <thead>\n            <tr>\n              <th>ID</th>\n              <th>NAME</th>\n              <th>EMAIL</th>\n              <th>ROLE</th>\n              <th>REGISTERED</th>\n              <th>ACTIONS</th>\n            </tr>\n          </thead>\n          <tbody>\n            {users.map((user) => (\n              <tr key={user._id}>\n                <td>{user._id}</td>\n                <td>{user.name}</td>\n                <td>\n                  <a href={`mailto:${user.email}`}>{user.email}</a>\n                </td>\n                <td>\n                  {user.role_id.name === 'admin' ? (\n                    <span className=\"text-success\">Admin</span>\n                  ) : (\n                    <span>Customer</span>\n                  )}\n                </td>\n                <td>{new Date(user.created_at).toLocaleDateString()}</td>\n                <td>\n                  {user.role_id.name === 'admin' ? (\n                    <Button\n                      variant=\"outline-primary\"\n                      className=\"btn-sm\"\n                      onClick={() => updateRoleHandler(user._id, 'customer')}\n                    >\n                      Make Customer\n                    </Button>\n                  ) : (\n                    <Button\n                      variant=\"outline-success\"\n                      className=\"btn-sm\"\n                      onClick={() => updateRoleHandler(user._id, 'admin')}\n                    >\n                      Make Admin\n                    </Button>\n                  )}\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </Table>\n      )}\n    </>\n  );\n};\n\nexport default AdminUsersPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}